<div class="container">
    <h1>Territory Detail Page</h1>
    <div class="list-group">
        <div class="col-xs-12">
            <div class="list-group-item well">
                <div class="row-content">
                    <h4 class="list-group-item-heading">
                            Territory #{{vm.territory.num}}
                        </h4>

                    <p class="list-group-item-text">
                        <span class="col-xs-6">{{vm.territory.description}}</span>
                        <span class="col-xs-6">{{vm.territory.status}}</span>
                        <span class="col-xs-6">{{vm.territory.type.unit}}</span>
                        <span class="col-xs-6">    
                            <select ng-model="vm.territory.type" ng-options="item as item.label for item in vm.territoryTypes track by item.value"></select>
                        </span>
                    </p>
                </div>
                <div class="row-picture pull-left">
                    <img class="circle pull-left" src="/src/client/images/mapIcon.png" alt="icon" ng-click="vm.goToDetail(territory.num)">
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <td class="col-xs-4">
            <button ng-click="vm.goToList()" class="btn btn-default">Go To List</button>
        </td>
    </div>
    <div class="well row">
        Addresses:<br>
        <div class="col-xs-12" ng-repeat="address in vm.visableAddresses">
            {{address.num}} {{address.street}} 
            <div ng-if="address != vm.selectedAddress"> 
                Last visit:</br>
                    </br>CheckOut: {{address.lastVisit.checkoutId}}
                    </br>Visit Date: {{address.lastVisit.date | date:'medium'}}
                    </br>State: {{address.lastVisit.state}}
                    </br>Language: {{address.lastVisit.language}}
                    </br>Notes : {{address.lastVisit.notes}}
            </div>
            <button ng-click="vm.selectedAddress = address">Add Visit</button>
            <div ng-if="vm.selectedAddress === address">
                <select ng-model="address.lastVisit.state" ng-options="item as item for item in vm.visitStates"></select>
                <select ng-model="address.lastVisit.language" ng-options="item as item for item in vm.languages"></select>
                <textarea ng-model="address.lastVisit.notes"></textarea>
                <button class="btn btn-default" ng-click="vm.saveVisit(address, address.lastVisit, vm.checkOutId)">Save Visit</button>
            </div>
            <hr><br>
        </div>
    </div>
    <div class="well row">
        Add Address<br>
        <div class="col-xs-2">
            Num: <input type="input" ng-model="vm.newAddress.num">
        </div>
        <div class="col-xs-2">
            Street: <input type="input" ng-model="vm.newAddress.street">
        </div>
        <div class="col-xs-2">
            Territory: <input type="input" ng-model="vm.newAddress.territoryNum">
        </div>
        <div class="col-xs-2">
            {{vm.territory.type.unit}}: <input type="input" ng-model="vm.newAddress.unit">
        </div>
        
        <div class="col-xs-12 panel">
            <pre>{{vm.newAddress | json }}<pre>
        </div>
        <div class="row">
            <td class="col-xs-12">
                <button ng-click="vm.saveAddress(vm.newAddress, vm.addresses)" class="btn btn-primary btn-raised">Add Address</button>
            </td>
        </div>
    </div>
    
</div>